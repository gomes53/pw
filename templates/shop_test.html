<!doctype html>
<html class="no-js" lang="zxx">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Fashion | Teamplate</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="site.webmanifest">
<link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static',    filename='img/favicon.ico') }}">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
<link rel="stylesheet" href="https://use.fontawesome.com/0206006232.css">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/bootstrap.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/owl.carousel.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/slicknav.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/flaticon.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/progressbar_barfiller.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/gijgo.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/animate.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/animated-headline.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/magnific-popup.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/fontawesome-all.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/themify-icons.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/slick.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/nice-select.css') }}">
<link rel="stylesheet" href="{{ url_for('static',    filename='css/style.css') }}">

<style>
  .input-cat{
    width: 100%;
    height: 45px;
    background: #fff;
    border-radius: 5px;
    padding: 11px 19px 11px 18px;
    color: #616875;
    line-height: 20px;
    border: 1px solid #ededed;
    margin-bottom: 20px
  }
  .button-cat{
    width: 100%;
    height: 45px;
    background: #ddd;
    border-radius: 5px;
    padding: 11px 19px 11px 18px;
    color: #616875;
    line-height: 20px;
    border: 1px solid #ededed;
    margin-bottom: 20px;
    cursor: pointer;
    transition: 0.5s;
  }
  .button-cat:hover{
    background: #ccc;
    transition: 0.5s;
  }
  .h_container{
    background-color: #cac7c7;
    border-radius: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,.1);
    display: inline-block;
    width:35px;
    height:35px;
    text-align:center;
    line-height:45px;
    margin-top: 15px;
  }
  #heart{
    color:white;
    font-size: 25px;
    transition: 0.1s;
  }
  #heart:hover{
    color:red;
    cursor: pointer;
    transition: 0.1s;
  }
  .faved {
    color: red !important;
    font-size: 25px;
    transition: 0.1s;
  }

/*the container must be positioned relative:*/
.autocomplete {
  position: relative;
}

input {
  border: 1px solid transparent;
  background-color: #f1f1f1;
  padding: 10px;
  font-size: 16px;
}

input[type=text] {
  background-color: #f1f1f1;
  width: 100%;
}

input[type=submit] {
  background-color: DodgerBlue;
  color: #fff;
  cursor: pointer;
}

.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-bottom: none;
  border-top: none;
  z-index: 99;
  /*position the autocomplete items to be the same width as the container:*/
  top: 100%;
  left: 0;
  right: 0;
}

.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  background-color: #fff; 
  border-bottom: 1px solid #d4d4d4; 
}

/*when hovering an item:*/
.autocomplete-items div:hover {
  background-color: #e9e9e9; 
}

/*when navigating through the items using the arrow keys:*/
.autocomplete-active {
  background-color: DodgerBlue !important; 
  color: #ffffff; 
}

  </style>

<script>
  var xmlhttp = new XMLHttpRequest();
  var typeAndid = window.location.href.split("/shop/")[1];
  var id = typeAndid.split("/")[1];
  var type = typeAndid.split("/")[0];
  var url = "/products/" + type +"/" + id;
  xmlhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
          var myArr = JSON.parse(this.responseText);
          printJ(myArr);
      }
  };
  xmlhttp.open("GET", url, true);
  xmlhttp.send();


  var productList = "";
  //Adds the dresses to the list
  function printJ(json){
    productList = "";
    // //var ul = document.getElementById("list");
    // console.log(json);
    // console.log(json.products);
    for(let i = 0; i < json.products.length; i++) {
      var product = json.products[i];
      var prodHTML = createProduct(product);
      productList += prodHTML;
      


    }
    document.getElementById("productList").innerHTML = productList;
  }


    function createProduct(product)  {
      var elastic_id = product._id
      var brand = product._source.brand;
      var gender = product._source.gender;
      var image = product._source.image_filename;
      var name = product._source.name;
      var price = product._source.price;
      
      return ("<div class=\"col-xl-4 col-lg-4 col-md-6 col-sm-6\">\n"+
"<div class=\"single-new-arrival mb-50 text-center\">\n"+
"<div style=\"width: 264px; height: 330px; overflow: hidden;\" class=\"popular-img\">\n"+
"<img id = img0 style=\"min-width: 100%; min-height: 100%;\" src=\"" + image + "\" alt=\"\">\n"+
"<div class=\"favorit-items\">\n"+
"<img src=\"{{ url_for('static',    filename='img/gallery/favorit-card.png') }}\" alt=\"\">\n"+
"</div>\n"+
"</div>\n"+
"<div class=\"popular-caption\">\n"+
"<h3><a id = name0 href=\"product_details.html\">" + name + "</a></h3>\n"+
"<div class=\"rating mb-10\">\n"+
// "<i class=\"fas fa-star\"></i>\n"+
// "<i class=\"fas fa-star\"></i>\n"+
// "<i class=\"fas fa-star\"></i>\n"+
// "<i class=\"fas fa-star\"></i>\n"+
// "<i class=\"fas fa-star\"></i>\n"+
"</div>\n"+
"<span id = price0 >" + price + " â‚¬" + "</span>\n"+
"<div id=\"" + elastic_id + "\" class=\"h_container\" onclick=\"favClick("+ elastic_id +")\">\n"+
"<i id=\"heart\" class=\"fas fa-heart\"></i>"+
"</div>\n"+
"</div>\n"+
"</div>\n"+
"</div>\n");
    }

  function useFilter()  {
    //filter/<currentIndex>&filter=taxonomy&text=red
    var filterSearch = "http://localhost:5000/filter/" + type + "/taxonomy/";
    document.getElementById("productList").innerHTML = "";
    
    var query = document.getElementById("searchString").value;
    console.log(query);
    var price = document.getElementById("price").value;
    console.log(price);
    favsList = [];
    favsList.push(query);
    if (price != "" && query == "")  {
        filterSearch += "empty/" + price;
    }
    if (query != "" && price == "") {
      filterSearch += query + "/empty/1/1000000";
    }
    if (query != "" && price != "") {
      filterSearch += query + "/empty/" + price;
    }
    xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            var myArr = JSON.parse(this.responseText);
            printJ(myArr);
        }
    };
    xmlhttp.open("GET", filterSearch, true);
    xmlhttp.send();

    document.getElementById("searchForm").reset()

  }

  function refineFilter(){
    //call function refine/type/taxonomy?f1=filtro1&f2=filtro2&f3=filtro3
    if(favsList.length < 3)  {
      alert("Selecione pelo menos 3 produtos")
      return
    }

    var refiner = "http://localhost:5000/refine/" + type + "/taxonomy";
    for (let i = 0; i < favsList.length; i++) {
      _char = i > 0 ? '&' : '?';
      refiner += _char + "f" + i + "=" + favsList[i].toString();
    }

    var xmlhttp2 = new XMLHttpRequest();
    xmlhttp2.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
          var myArr = JSON.parse(this.responseText);
          printJ(myArr);
      }
    };
    xmlhttp2.open("GET", refiner, true);
    xmlhttp2.send();
    favsList = [];
  }

//******************************************************************************************************
  let faved = "faved";
  var favsList = [];
//******************************************************************************************************
  function favClick(id){
    var fav = document.getElementById(id);
    if(favsList.includes(id)){
      const index = favsList.indexOf(id);
      if (index > -1) {
        favsList.splice(index, 1);
      }
      fav.firstElementChild.classList.remove(faved);
      console.log("yup" + id);
    } else {
      favsList.push(id);
      fav.firstElementChild.classList.add(faved);
      console.log("nop" + id);
    }
  }

//********************************************
function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
  var currentFocus;
  /*execute a function when someone writes in the text field:*/
  inp.addEventListener("input", function(e) {
      var valwords = this.value.split(" ");
      var a, b, i, val = valwords[valwords.length-1];
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
          b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
              var inpVals = inp.value.split(" ");
              inpVals[inpVals.length-1] = this.getElementsByTagName("input")[0].value;
              inp.value = inpVals.join(" ");
              // inp.value = this.getElementsByTagName("input")[0].value;
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });
  /*execute a function presses a key on the keyboard:*/
  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
      }
  });
  function addActive(x) {
    /*a function to classify an item as "active":*/
    if (!x) return false;
    /*start by removing the "active" class on all items:*/
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
        x[i].parentNode.removeChild(x[i]);
      }
    }
  }
  /*execute a function when someone clicks in the document:*/
  document.addEventListener("click", function (e) {
      closeAllLists(e.target);
  });
}
var xmlhttp3 = new XMLHttpRequest();
xmlhttp3.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
      var myArr = JSON.parse(this.responseText);
      autocomplete(document.getElementById("searchString"), myArr);
  }
};
xmlhttp3.open("GET", "/search/dictionary", true);
xmlhttp3.send();

function submitForm(){
  document.getElementById("searchForm").submit();
}
</script>
</head>
<body class="full-wrapper">

<div id="preloader-active">
<div class="preloader d-flex align-items-center justify-content-center">
<div class="preloader-inner position-relative">
<div class="preloader-circle"></div>
<div class="preloader-img pere-text">
<img src="{{ url_for('static',    filename='img/logo/loder.png') }}" alt="">
</div>
</div>
</div>
</div>

<main>

<div class="">
<div class="container">
<div class="row">
<div class="col-xl-7 col-lg-8 col-md-10">
<div class="section-tittle mb-50">
  <a href = "http://localhost:5000">
    <h2>Shop with us</h2>
  </a>

</div>
</div>
</div>
<div class="row">

  <div class="col-xl-3 col-lg-3 col-md-4 ">
  
  <div class="category-listing mb-50">
  
  <div class="single-listing">
  
  <div class="select-job-items2">
    <form id="searchForm" autocomplete="off">
      <div class="autocomplete">
        <input id="searchString" type="text" name="searchString" placeholder="Search Products">
      </div>
      <input id="price" type="text" name="price" placeholder="Price (min/max)">
    </form>
  </div>
  <!-- <div class="select-job-items2">
    <input id = "color" class="input-cat" placeholder="Color"></input>
  </div> -->
  <!-- <div class="select-job-items2">
    <input id = "price" class="input-cat" placeholder="Price (min/max)">
    </input>
  </div> -->
  <div class="select-job-items2">
    <button type="button" class="button-cat" onclick="useFilter()">
      Search
    </button>
  </div>
  <div class="select-job-items2">
    <button type="button" class="button-cat" onclick="refineFilter()">
      Search again
    </button>
  </div>

</div>
</div>

</div>

<div class="col-xl-9 col-lg-9 col-md-8 ">
<div class="new-arrival new-arrival2">
<div id="productList" class="row">

</div>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

</div>

</main>

<div class="search-model-box">
<div class="h-100 d-flex align-items-center justify-content-center">
<div class="search-close-btn">+</div>
<form class="search-model-form">
<input type="text" id="search-input" placeholder="Searching key.....">
</form>
</div>
</div>

<div style = "text-align: center; padding-bottom: 100px;">
  <a id = "back_arrow" href = "" >
    <img style = "display: inline-block; margin-left: auto; margin-right: auto; height: 50px; transform: rotate(180deg); " src="{{ url_for('static',    filename='img/icon/arrow.png') }}" alt="">
  </a>
  <a id = "front_arrow" href = "" >
    <img style = "display: inline-block; margin-left: auto; margin-right: auto; height: 50px;" src="{{ url_for('static',    filename='img/icon/arrow.png') }}" alt="">  
  </a>
  </div>
<div id="back-top">
<a title="Go to Top" href="#"> <i class="fas fa-level-up-alt"></i></a>
</div>

<script>
  var typeAndid = window.location.href.split("/shop/")[1];
  var pageID = typeAndid.split("/")[1];
  var next = parseInt(pageID) +1;
  var prev = parseInt(pageID)- 1;
  if(pageID == 1) {
    document.getElementById("back_arrow").href = window.location.href;
    document.getElementById("front_arrow").href = window.location.href.split("/" + pageID)[0] + "/" + next;
  } else {
    document.getElementById("back_arrow").href = window.location.href.split("/" + pageID)[0] + "/" + prev;
    document.getElementById("front_arrow").href = window.location.href.split("/" + pageID)[0] + "/" + next;
  }
</script>

<script src="{{ url_for('static',    filename='js/vendor/modernizr-3.5.0.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/vendor/jquery-1.12.4.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/popper.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/bootstrap.min.js') }}"></script>

<script src="{{ url_for('static',    filename='js/owl.carousel.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/slick.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.slicknav.min.js') }}"></script>

<script src="{{ url_for('static',    filename='js/wow.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/animated.headline.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.magnific-popup.js') }}"></script>
<script src="{{ url_for('static',    filename='js/gijgo.min.js') }}"></script>

<script src="{{ url_for('static',    filename='js/jquery.nice-select.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.sticky.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.barfiller.js') }}"></script>

<script src="{{ url_for('static',    filename='js/jquery.counterup.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/waypoints.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.countdown.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/hover-direction-snake.min.js') }}"></script>

<script src="{{ url_for('static',    filename='js/contact.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.form.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.validate.min.js') }}"></script>
<script src="{{ url_for('static',    filename='js/mail-script.js') }}"></script>
<script src="{{ url_for('static',    filename='js/jquery.ajaxchimp.min.js') }}"></script>

<script src="{{ url_for('static',    filename='js/plugins.js') }}"></script>
<script src="{{ url_for('static',    filename='js/main.js') }}"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>
</body>
</html>